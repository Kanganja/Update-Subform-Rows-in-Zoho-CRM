<section class="elementor-section elementor-top-section elementor-element elementor-element-fffdfab elementor-section-boxed elementor-section-height-default elementor-section-height-default" data-element_type="section" data-id="fffdfab" style="--align-content: initial; --align-items: initial; --align-self: initial; --flex-basis: initial; --flex-direction: initial; --flex-grow: initial; --flex-shrink: initial; --flex-wrap: initial; --gap: initial; --justify-content: initial; --order: initial; --swiper-navigation-size: 44px; --swiper-pagination-bullet-horizontal-gap: 6px; --swiper-pagination-bullet-size: 6px; --swiper-theme-color: #000; --widgets-spacing: 20px 20px; align-self: var(--align-self); background-color: white; box-sizing: border-box; flex-basis: var(--flex-basis); flex-grow: var(--flex-grow); flex-shrink: var(--flex-shrink); font-family: Helvetica, sans-serif; order: var(--order); position: relative;"><div class="elementor-container elementor-column-gap-default" style="box-sizing: border-box; display: flex; margin-left: auto; margin-right: auto; max-width: 800px; position: relative;"><div class="elementor-column elementor-col-100 elementor-top-column elementor-element elementor-element-1acb149" data-element_type="column" data-id="1acb149" style="--align-content: initial; --align-items: initial; --align-self: initial; --flex-basis: initial; --flex-direction: initial; --flex-grow: initial; --flex-shrink: initial; --flex-wrap: initial; --gap: initial; --justify-content: initial; --order: initial; --swiper-navigation-size: 44px; --swiper-pagination-bullet-horizontal-gap: 6px; --swiper-pagination-bullet-size: 6px; --swiper-theme-color: #000; --widgets-spacing: 20px 20px; align-self: var(--align-self); box-sizing: border-box; display: flex; flex-basis: var(--flex-basis); flex-grow: var(--flex-grow); flex-shrink: var(--flex-shrink); min-height: 1px; order: var(--order); position: relative; width: 800px;"><div class="elementor-widget-wrap elementor-element-populated" style="align-content: flex-start; box-sizing: border-box; display: flex; flex-wrap: wrap; padding: 10px; position: relative; width: 800px;"><div class="elementor-element elementor-element-01dab7b elementor-widget elementor-widget-text-editor" data-element_type="widget" data-id="01dab7b" data-widget_type="text-editor.default" style="--align-content: initial; --align-items: initial; --align-self: initial; --flex-basis: initial; --flex-direction: initial; --flex-grow: initial; --flex-shrink: initial; --flex-wrap: initial; --gap: initial; --justify-content: initial; --order: initial; --swiper-navigation-size: 44px; --swiper-pagination-bullet-horizontal-gap: 6px; --swiper-pagination-bullet-size: 6px; --swiper-theme-color: #000; --widgets-spacing: 20px 20px; align-content: var(--align-content); align-items: var(--align-items); align-self: var(--align-self); box-sizing: border-box; flex-basis: var(--flex-basis); flex-direction: var(--flex-direction); flex-grow: var(--flex-grow); flex-shrink: var(--flex-shrink); flex-wrap: var(--flex-wrap); font-family: Arboria, sans-serif; gap: var(--gap); justify-content: var(--justify-content); margin-block-end: 20px; margin-bottom: 20px; order: var(--order); position: relative; width: 780px;"><div class="elementor-widget-container" style="box-sizing: border-box; transition: background .3s,border .3s,border-radius .3s,box-shadow .3s,transform var(--e-transform-transition-duration,.4s);"><h2 style="box-sizing: border-box; color: var(--global-palette3); line-height: 1.5; margin: 0px; padding: 0px;"><p style="text-align: left;"><span style="font-weight: normal;"><span style="font-size: small;">If you've tried searching for ways to add subform rows in Zoho CRM without overwriting existing ones, you've likely stumbled upon <a href="https://www.zoho.com/crm/developer/docs/api/v2/subforms.html" target="_blank">API documentation</a>. While APIs work well, they may seem complex, especially if you want to perform this entirely within Zoho CRM using Deluge scripting. Here’s a simpler, API-free approach to solve this.</span></span></p><hr style="font-size: 28px;" /></h2><h2 style="text-align: left;"><span style="font-size: medium;">Why Add Subform Rows Dynamically?</span></h2><h2 style="box-sizing: border-box; color: var(--global-palette3); line-height: 1.5; margin: 0px; padding: 0px;"><p style="text-align: left;"><span style="font-weight: normal;"><span style="font-size: small;">Subforms in Zoho CRM act as embedded spreadsheets that let you store multiple line items for a single record. Adding rows dynamically via Deluge scripting can unlock exciting possibilities, such as:</span></span></p><p style="text-align: left;"></p><ul><li><span style="font-weight: normal;"><span style="font-size: small;">Activity Logs: Track every outreach on a Lead in a subform called "Outreach Log."</span></span></li><li><span style="font-weight: normal;"><span style="font-size: small;">Product Sales Tracking: Sync subform data from Deals to an Accounts subform, creating a consolidated&nbsp; view of all products sold under the Account.</span></span></li></ul><p></p><hr style="font-size: 28px;" /></h2><h2 style="text-align: left;"><span style="font-size: medium;">Step-by-Step Guide to Add Subform Rows Without Overwriting Existing Data</span></h2><h3 style="font-size: 17px; text-align: left;">1. <strong>Create a Map for the New Row</strong></h3><p style="font-size: 17px; text-align: left;"><span style="color: var(--global-palette3); font-size: medium; font-weight: normal;">Start by creating a </span><code style="color: var(--global-palette3); font-weight: normal;">Map</code><span style="color: var(--global-palette3); font-size: medium; font-weight: normal;"> object with keys corresponding to your subform fields and the respective values for the new row.</span><span style="color: var(--global-palette3); font-weight: 700; white-space: pre;">Note:</span><span style="color: var(--global-palette3); font-weight: 700; white-space: pre;"> </span><span style="color: var(--global-palette3); white-space: pre;">Replace the keys (</span><code style="color: var(--global-palette3); white-space: pre;">"Product"</code><span style="color: var(--global-palette3); white-space: pre;">, </span><code style="color: var(--global-palette3); white-space: pre;">"Quantity"</code><span style="color: var(--global-palette3); white-space: pre;">, etc.) with your subform field API names.</span></p><h2 style="box-sizing: border-box; color: var(--global-palette3); line-height: 1.5; margin: 0px; padding: 0px;"><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-deluge"><span style="font-weight: normal;"><span style="font-size: small;">updateMap = Map();
updateMap.put("Product", "Apples");
updateMap.put("Quantity", 50);
updateMap.put("Price", 2);</span></span></code></div></div></pre></h2><h3 style="text-align: left;"><span style="font-size: medium;">2. <strong>Add the Map to a List</strong></span></h3><h3 style="text-align: left;"><span style="color: var(--global-palette3); font-size: medium; font-weight: normal;">Add the newly created </span><code style="color: var(--global-palette3); font-weight: normal;">Map</code><span style="color: var(--global-palette3); font-size: medium; font-weight: normal;"> into a </span><code style="color: var(--global-palette3); font-weight: normal;">List</code><span style="color: var(--global-palette3); font-size: medium; font-weight: normal;">.</span></h3><h2 style="box-sizing: border-box; color: var(--global-palette3); line-height: 1.5; margin: 0px; padding: 0px;"><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><p style="text-align: left;"><span style="font-size: medium;"><code class="!whitespace-pre hljs language-deluge"><span style="font-weight: normal;">updateList = List();<br /></span></code><code class="!whitespace-pre hljs language-deluge"><span style="font-weight: normal;">updateList.add(updateMap);</span></code></span></p></div></pre></h2><h3 style="text-align: left;"><span style="font-size: medium;">3. <strong>Preserve Existing Rows</strong></span></h3><h2 style="box-sizing: border-box; color: var(--global-palette3); line-height: 1.5; margin: 0px; padding: 0px;"><p style="text-align: left;"><span style="font-weight: normal;"><span style="font-size: small;">Fetch the existing subform rows to ensure they’re not overwritten. Use the following steps:</span></span></p><p style="text-align: left;"></p><ul style="text-align: left;"><li><span style="color: var(--global-palette3); font-size: medium; font-weight: normal;">Retrieve the record using </span><code style="color: var(--global-palette3); font-weight: normal;">zoho.crm.getRecordById</code><span style="color: var(--global-palette3); font-size: medium; font-weight: normal;">.</span></li><li><span style="color: var(--global-palette3); font-size: medium; font-weight: normal;">Access the subform field using its API name.</span></li><li><span style="color: var(--global-palette3); font-weight: normal;"><span style="font-size: small;">Iterate through each subform row and add it to <code>updateList</code> by including its <code>id</code>.</span></span></li></ul><pre class="!overflow-visible" style="text-align: left;"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><p><span style="font-size: small;"><code class="!whitespace-pre hljs language-deluge"><span style="font-weight: normal;">record = zoho.crm.getRecordById("Quotes", "683769000000338181"); // Replace with module and record ID<br /></span></code><code class="!whitespace-pre hljs language-deluge"><span style="font-weight: normal;">subform = record.get("Quoted_Items"); // Replace with subform API name</span></code><code class="!whitespace-pre hljs language-deluge"><span style="font-weight: normal;">
</span></code><code class="!whitespace-pre hljs language-deluge"><span style="font-weight: normal;">for each s in subform {<br /></span></code><code class="!whitespace-pre hljs language-deluge"><span style="font-weight: normal;">    updateList.add({"id": s.get("id")});<br /></span></code><code class="!whitespace-pre hljs language-deluge"><span style="font-weight: normal;">}</span></code></span></p></div></pre></h2><h3 style="text-align: left;"><span style="font-size: small;">4. <strong>Update the Subform</strong></span></h3><h2 style="box-sizing: border-box; color: var(--global-palette3); line-height: 1.5; margin: 0px; padding: 0px;"><p><span style="font-weight: normal;"><span style="font-size: small;">Use the <code>zoho.crm.updateRecord</code> function to update the subform with the complete <code>updateList</code>.</span></span></p><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-deluge"><span style="font-weight: normal;"><span style="font-size: small;">updateCRM = zoho.crm.updateRecord("Quotes", "683769000000338181", {"Quoted_Items": updateList});
info updateCRM;</span></span><span style="font-size: 28px;">
</span></code></div></div></pre><hr style="font-size: 28px;" /></h2><h3><span style="font-size: small;">Scenario: Calculating and Updating Subform Fields</span></h3><h2 style="box-sizing: border-box; color: var(--global-palette3); line-height: 1.5; margin: 0px; padding: 0px;"><p><span style="font-size: small; font-weight: normal;">Let’s say you have a subform <code>Quoted_Items</code> with three fields: <code>Quantity</code>, <code>Standard_Price</code>, and <code>Extended_Standard_Price</code>. You want to automatically calculate <code>Extended_Standard_Price</code> as <code>Quantity * Standard_Price</code> and update it for each row.</span></p><p><span style="font-size: small;">Here’s the Deluge code to achieve this:</span></p><pre class="!overflow-visible"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary dark:bg-gray-950"><div class="overflow-y-auto p-4" dir="ltr"><span style="font-weight: normal;"><code class="!whitespace-pre hljs language-deluge"><span style="font-size: small;">// Replace </span><span style="font-size: x-small;">"</span></code><span style="font-size: x-small;"><span style="color: var(--global-palette3); font-family: Arboria, sans-serif;">quoteId" </span><span style="color: var(--global-palette3); font-family: Arboria, sans-serif;">with your Quote record ID</span></span></span></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre hljs language-deluge"><span style="font-size: small;"><span style="font-weight: normal;">fetch_record = invokeurl
[
    url: "https://www.zohoapis.in/crm/v6/Quotes/quoteId"
    type: GET
    connection: "fetch_data_1"
];

// Parse the JSON response
information = fetch_record.get("data");

for each rec in information {
    quoted_items = rec.get("Quoted_Items"); // Fetch subform data
    extended_standard_prices = List();

    // Process each subform row
    for each item in quoted_items {
        subform = Map();
        subform.put("id", item.get("id")); // Preserve existing row ID

        // Fetch and calculate values
        quantity = ifnull(item.get("Quantity"), 0);
        standard_price = ifnull(item.get("Standard_Price"), 0);
        extended_standard_price = quantity * standard_price;

        // Update the calculated field
        subform.put("Extended_Standard_Price", extended_standard_price);
        extended_standard_prices.add(subform);
    }

    // Update the CRM record with change subform data
    main_map = Map();
    main_map.put("Quoted_Items", extended_standard_prices);
    update_resp1 = zoho.crm.updateRecord("Quotes", rec.get("id"), main_map);
    info update_resp1;
}</span>
</span></code></div></div></pre><hr /></h2></div></div></div></div></div></section>
